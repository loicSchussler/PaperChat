<div class="library-container">
  <div class="library-header">
    <h1>Bibliothèque d'articles</h1>
    <span class="paper-count">{{ papers.length }} document(s)</span>
  </div>

  <div *ngIf="loading" class="loading-container">
    <mat-spinner></mat-spinner>
  </div>

  <div *ngIf="!loading && papers.length === 0" class="empty-state">
    <mat-icon>library_books</mat-icon>
    <p>Aucun article indexé. Commencez par uploader un PDF!</p>
    <button mat-raised-button color="primary" routerLink="/upload">
      <mat-icon>upload_file</mat-icon>
      Upload un article
    </button>
  </div>

  <div class="papers-grid" *ngIf="!loading && papers.length > 0">
    <mat-card class="paper-card" *ngFor="let paper of papers" (click)="openPdfViewer(paper)">
      <div class="card-preview">
        <mat-icon class="pdf-icon">picture_as_pdf</mat-icon>
        <div class="preview-overlay">
          <mat-icon>visibility</mat-icon>
          <span>Voir le PDF</span>
        </div>
      </div>

      <mat-card-content>
        <h3 class="paper-title">{{ paper.title }}</h3>

        <div class="paper-meta">
          <div class="authors" *ngIf="paper.authors && paper.authors.length > 0">
            <mat-icon class="meta-icon">people</mat-icon>
            <span>{{ paper.authors.join(', ') }}</span>
          </div>

          <div class="year" *ngIf="paper.year">
            <mat-icon class="meta-icon">calendar_today</mat-icon>
            <span>{{ paper.year }}</span>
          </div>

          <div class="chunks">
            <mat-icon class="meta-icon">category</mat-icon>
            <span>{{ paper.nb_chunks }} chunks</span>
          </div>
        </div>

        <div class="keywords" *ngIf="paper.keywords && paper.keywords.length > 0">
          <mat-chip-set>
            <mat-chip *ngFor="let keyword of paper.keywords.slice(0, 3)">
              {{ keyword }}
            </mat-chip>
            <mat-chip *ngIf="paper.keywords.length > 3">
              +{{ paper.keywords.length - 3 }}
            </mat-chip>
          </mat-chip-set>
        </div>

        <p class="abstract" *ngIf="paper.abstract">
          {{ paper.abstract.substring(0, 150) }}{{ paper.abstract.length > 150 ? '...' : '' }}
        </p>
      </mat-card-content>

      <mat-card-actions>
        <button mat-button (click)="openPdfViewer(paper)">
          <mat-icon>visibility</mat-icon>
          Voir
        </button>
        <button mat-button color="warn" (click)="deletePaper(paper, $event)">
          <mat-icon>delete</mat-icon>
          Supprimer
        </button>
      </mat-card-actions>
    </mat-card>
  </div>
</div>
